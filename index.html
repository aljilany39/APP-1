<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ù…ÙˆÙ‚Ø¹ Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</title>
  <style>
    :root{
      --bg:#f3f4f6; --card:#ffffff; --accent:#0ea5a4; --muted:#6b7280;
      --success:#d1fae5; --danger:#fee2e2;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial; background:var(--bg); color:#0f172a;}
    .wrap{max-width:900px;margin:18px auto;padding:16px;}
    header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:12px}
    h1{margin:0;font-size:20px}
    .controls{display:flex;gap:8px;flex-wrap:wrap}
    button{cursor:pointer;border:0;background:var(--card);padding:8px 10px;border-radius:8px;box-shadow:0 1px 2px rgba(0,0,0,0.05)}
    .primary{background:var(--accent);color:#fff}
    .card{background:var(--card);padding:14px;border-radius:12px;box-shadow:0 6px 18px rgba(2,6,23,0.06); margin-bottom:12px}
    .grid{display:grid;gap:10px}
    .cols-2{grid-template-columns:1fr 1fr}
    label{font-size:13px;color:var(--muted);display:block;margin-bottom:6px}
    input[type="text"]{width:100%;padding:10px;border:1px solid #e6e9ee;border-radius:8px}
    .list{display:grid;gap:8px}
    .card-row{display:flex;align-items:center;justify-content:space-between;gap:8px}
    .small{font-size:13px;color:var(--muted)}
    .options-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-top:12px}
    .option{padding:14px;border-radius:10px;background:#fff;border:1px solid #f1f5f9;font-weight:600}
    .option.correct{background:var(--success);border-color:#10b981}
    .option.wrong{background:var(--danger);border-color:#f43f5e}
    .muted{color:var(--muted)}
    footer{margin-top:16px;text-align:center;color:var(--muted);font-size:13px}
    @media (max-width:520px){
      .cols-2{grid-template-columns:1fr}
      .options-grid{grid-template-columns:1fr}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Ù…ÙˆÙ‚Ø¹ Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</h1>
        <div class="small">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¹Ù†Ù‰ Ø§Ù„ØµØ­ÙŠØ­ Ù…Ù† 6 Ø®ÙŠØ§Ø±Ø§Øª â€” Ø§Ù„Ù‚Ø§Ù…ÙˆØ³ Ù…Ù…Ù„ÙˆÙƒ Ù„Ùƒ (Ø§Ù„Ù…Ø¹Ù†Ù‰ ØªÙƒØªØ¨Ù‡ Ø¨Ù†ÙØ³Ùƒ)</div>
      </div>
      <div class="controls">
        <button id="btn-dashboard" class="primary">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
        <button id="btn-add">Ø£Ø¶Ù Ø¨Ø·Ø§Ù‚Ø©</button>
        <button id="btn-review">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</button>
        <button id="btn-export">ØªØµØ¯ÙŠØ±</button>
        <label style="display:inline-block;cursor:pointer;padding:6px 10px;border-radius:8px;background:#fff;border:1px solid #e6e9ee">
          Ø§Ø³ØªÙŠØ±Ø§Ø¯
          <input id="import-file" type="file" accept="application/json" style="display:none">
        </label>
      </div>
    </header>

    <main id="main">

      <!-- Dashboard -->
      <section id="view-dashboard" class="card">
        <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;margin-bottom:10px">
          <div>
            <div class="small">Ø¹Ø¯Ø¯ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª</div>
            <div style="font-weight:700;font-size:18px" id="cards-count">0</div>
          </div>
          <div>
            <div class="small">Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø¬Ù„Ø³Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©</div>
            <div style="font-weight:700;font-size:18px" id="session-score">0</div>
          </div>
        </div>

        <div class="card">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
            <div class="small">Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª (Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© Ù„Ø¨Ø¯Ø¡ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¨Ø·Ø§Ù‚Ø© Ù…ÙØ±Ø¯Ø©)</div>
            <div class="small muted">ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø²Ø± Ø§Ù„ØªØµØ¯ÙŠØ± Ù„Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©</div>
          </div>
          <div id="cards-list" class="list"></div>
        </div>
      </section>

      <!-- Add -->
      <section id="view-add" class="card" style="display:none">
        <h3 style="margin-top:0">Ø£Ø¶Ù Ø¨Ø·Ø§Ù‚Ø© Ø¬Ø¯ÙŠØ¯Ø©</h3>
        <form id="add-form" class="grid">
          <div>
            <label>Ø§Ù„ÙƒÙ„Ù…Ø© (Ø¨Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©)</label>
            <input id="field-word" type="text" placeholder="Ù…Ø«Ø§Ù„: apple">
          </div>
          <div>
            <label>Ø§Ù„Ù…Ø¹Ù†Ù‰ (ØªÙƒØªØ¨Ù‡ Ø¨Ù†ÙØ³Ùƒ)</label>
            <input id="field-meaning" type="text" placeholder="Ù…Ø«Ø§Ù„: ØªÙØ§Ø­Ø©">
          </div>
          <div style="display:flex;gap:8px">
            <button type="submit" class="primary">Ø£Ø¶Ù</button>
            <button type="button" id="btn-clear">Ù…Ø³Ø­</button>
          </div>
          <div class="small muted">Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ø¶Ø§ÙØ©ØŒ Ø³ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ø¹Ø§Ù†ÙŠ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰ Ù„ØªÙˆÙ„ÙŠØ¯ Ø®ÙŠØ§Ø±Ø§Øª Ø®Ø§Ø·Ø¦Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.</div>
        </form>
      </section>

      <!-- Review -->
      <section id="view-review" class="card" style="display:none">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
          <div class="small">Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¨Ø·Ø§Ù‚Ø© <span id="review-index">0</span> / <span id="review-total">0</span></div>
          <div class="small">Ù†Ù‚Ø§Ø· Ø§Ù„Ø¬Ù„Ø³Ø©: <span id="review-score">0</span></div>
        </div>

        <div style="text-align:center;margin-bottom:10px">
          <div style="font-size:28px;font-weight:700" id="review-word">â€”</div>
          <div style="margin-top:8px">
            <button id="btn-pronounce">ğŸ”Š Ù†Ø·Ù‚</button>
          </div>
        </div>

        <div id="options" class="options-grid"></div>
      </section>

      <!-- Results -->
      <section id="view-results" class="card" style="display:none">
        <h3 style="margin-top:0">Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø¬Ù„Ø³Ø©</h3>
        <div class="small">Ø¯Ø±Ø¬ØªÙƒ: <span id="final-score">0</span> / <span id="final-total">0</span></div>
        <div style="margin-top:12px">
          <div class="small" style="font-weight:700">Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„ØªÙŠ Ø£Ø®Ø·Ø£Øª ÙÙŠÙ‡Ø§:</div>
          <ul id="wrong-list" class="small"></ul>
        </div>
        <div style="margin-top:12px;display:flex;gap:8px">
          <button id="btn-restart" class="primary">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¬Ù„Ø³Ø©</button>
          <button id="btn-back-dashboard">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
        </div>
      </section>

    </main>

    <footer>
      <div class="small muted">Ø­ÙØ¸ Ù…Ø­Ù„ÙŠØ§Ù‹ Ø¹Ù„Ù‰ Ø¬Ù‡Ø§Ø²Ùƒ â€” ÙŠÙ…ÙƒÙ†Ùƒ ØªØµØ¯ÙŠØ±/Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª ÙƒÙ€ JSON.</div>
    </footer>
  </div>

<script>
/* Ø¨Ø·Ø§Ù‚Ø§Øª Ø¬Ø§Ù‡Ø²Ø© (English words) */
const SAMPLE_CARDS = [
  { word: "apple", correct: "ØªÙØ§Ø­Ø©" },
  { word: "book", correct: "ÙƒØªØ§Ø¨" },
  { word: "cat", correct: "Ù‚Ø·Ø©" },
  { word: "dog", correct: "ÙƒÙ„Ø¨" },
  { word: "house", correct: "Ù…Ù†Ø²Ù„" },
  { word: "car", correct: "Ø³ÙŠØ§Ø±Ø©" },
  { word: "water", correct: "Ù…Ø§Ø¡" },
  { word: "phone", correct: "Ù‡Ø§ØªÙ" },
  { word: "table", correct: "Ø·Ø§ÙˆÙ„Ø©" },
  { word: "chair", correct: "ÙƒØ±Ø³ÙŠ" },
  { word: "sun", correct: "Ø´Ù…Ø³" },
  { word: "moon", correct: "Ù‚Ù…Ø±" }
];

const STORAGE_KEY = 'simple-flashcards-v1';

/* --- State --- */
let cards = [];
let queue = [];
let index = 0;
let score = 0;
let wrongCards = [];

/* --- Helpers --- */
function save() {
  try { localStorage.setItem(STORAGE_KEY, JSON.stringify(cards)); } catch(e){ console.error(e) }
}
function load() {
  const raw = localStorage.getItem(STORAGE_KEY);
  if (raw) {
    try { cards = JSON.parse(raw); }
    catch(e){ cards = SAMPLE_CARDS.slice(); save(); }
  } else {
    cards = SAMPLE_CARDS.slice(); save();
  }
}
function uid(){ return Date.now().toString(36) + Math.random().toString(36).slice(2,6); }
function shuffle(arr){ for(let i=arr.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[arr[i],arr[j]]=[arr[j],arr[i]]} return arr; }

/* Build options: correct + up to 5 wrongs from other cards */
function buildOptions(card){
  const pool = cards.map(c => c.correct).filter(m => m && m !== card.correct);
  shuffle(pool);
  const wrongs = pool.slice(0,5);
  while(wrongs.length < 5) wrongs.push("Ø®ÙŠØ§Ø± ØºÙŠØ± ØµØ­ÙŠØ­");
  const opts = shuffle([card.correct, ...wrongs].slice(0,6));
  return opts;
}

/* UI elements */
const el = {
  dashboard: document.getElementById('view-dashboard'),
  add: document.getElementById('view-add'),
  review: document.getElementById('view-review'),
  results: document.getElementById('view-results'),
  cardsList: document.getElementById('cards-list'),
  count: document.getElementById('cards-count'),
  sessionScore: document.getElementById('session-score'),
  addForm: document.getElementById('add-form'),
  wordField: document.getElementById('field-word'),
  meaningField: document.getElementById('field-meaning'),
  reviewWord: document.getElementById('review-word'),
  reviewIndex: document.getElementById('review-index'),
  reviewTotal: document.getElementById('review-total'),
  reviewScore: document.getElementById('review-score'),
  optionsWrap: document.getElementById('options'),
  pronounceBtn: document.getElementById('btn-pronounce'),
  finalScore: document.getElementById('final-score'),
  finalTotal: document.getElementById('final-total'),
  wrongList: document.getElementById('wrong-list'),
};

/* Navigation buttons */
document.getElementById('btn-dashboard').onclick = ()=>show('dashboard');
document.getElementById('btn-add').onclick = ()=>show('add');
document.getElementById('btn-review').onclick = startReview;
document.getElementById('btn-export').onclick = exportJSON;
document.getElementById('import-file').onchange = importJSON;
document.getElementById('btn-clear').onclick = ()=>{ el.wordField.value=''; el.meaningField.value=''; };
document.getElementById('btn-restart').onclick = startReview;
document.getElementById('btn-back-dashboard').onclick = ()=>show('dashboard');

/* Add form */
el.addForm.addEventListener('submit', (e)=>{
  e.preventDefault();
  const w = el.wordField.value.trim();
  const m = el.meaningField.value.trim();
  if(!w || !m){ alert('Ø§Ø¯Ø®Ù„ Ø§Ù„ÙƒÙ„Ù…Ø© ÙˆØ§Ù„Ù…Ø¹Ù†Ù‰'); return; }
  const newCard = { id: uid(), word: w, correct: m };
  cards.unshift(newCard);
  save();
  el.wordField.value=''; el.meaningField.value='';
  refreshList();
  show('dashboard');
});

/* Pronounce */
document.getElementById('btn-pronounce').onclick = () => {
  const text = el.reviewWord.textContent || '';
  if(!text) return;
  if('speechSynthesis' in window){
    window.speechSynthesis.cancel();
    const u = new SpeechSynthesisUtterance(text);
    u.lang = 'en-US';
    const voices = window.speechSynthesis.getVoices();
    const v = voices.find(x=>x.lang && x.lang.startsWith('en'));
    if(v) u.voice = v;
    window.speechSynthesis.speak(u);
  } else alert('Ø§Ù„Ù†Ø·Ù‚ ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ… ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­');
}

/* Show view */
function show(name){
  ['dashboard','add','review','results'].forEach(k=>{
    document.getElementById('view-'+k).style.display = (k===name ? '' : 'none');
  });
  if(name==='dashboard') refreshList();
  if(name==='results') renderResults();
}

/* Refresh cards list on dashboard */
function refreshList(){
  el.cardsList.innerHTML = '';
  el.count.textContent = cards.length;
  el.sessionScore.textContent = score;
  if(cards.length===0){ el.cardsList.innerHTML = '<div class="small muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨Ø·Ø§Ù‚Ø§Øª</div>'; return; }
  cards.forEach(c=>{
    const row = document.createElement('div');
    row.className = 'card-row';
    row.innerHTML = `
      <div>
        <div style="font-weight:700">${c.word}</div>
        <div class="small muted">${c.correct}</div>
      </div>
      <div style="display:flex;gap:6px;align-items:center">
        <button title="Ù†Ø·Ù‚" class="muted" data-pronounce>ğŸ”Š</button>
        <button data-review class="" style="padding:6px 8px;border-radius:8px">Ù…Ø±Ø§Ø¬Ø¹Ø©</button>
        <button data-delete class="small" style="color:#ef4444">Ø­Ø°Ù</button>
      </div>
    `;
    el.cardsList.appendChild(row);

    row.querySelector('[data-pronounce]').onclick = () => {
      if('speechSynthesis' in window){
        window.speechSynthesis.cancel();
        const u = new SpeechSynthesisUtterance(c.word);
        u.lang = 'en-US';
        const voices = window.speechSynthesis.getVoices();
        const v = voices.find(x=>x.lang && x.lang.startsWith('en'));
        if(v) u.voice = v;
        window.speechSynthesis.speak(u);
      } else alert('Ø§Ù„Ù†Ø·Ù‚ ØºÙŠØ± Ù…ØªØ§Ø­');
    };
    row.querySelector('[data-review]').onclick = ()=>{
      // single-card review session
      queue = [c];
      index = 0;
      score = 0;
      wrongCards = [];
      show('review');
      startCard();
    };
    row.querySelector('[data-delete]').onclick = ()=>{
      if(confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©ØŸ')){
        cards = cards.filter(x=>x !== c);
        save();
        refreshList();
      }
    };
  });
}

/* Start full review (all cards randomized) */
function startReview(){
  if(cards.length===0){ alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨Ø·Ø§Ù‚Ø§Øª Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©'); return; }
  queue = cards.slice();
  shuffle(queue);
  index = 0;
  score = 0;
  wrongCards = [];
  show('review');
  startCard();
}

/* Start current card */
function startCard(){
  const current = queue[index];
  if(!current) { show('results'); return; }
  el.reviewWord.textContent = current.word;
  el.reviewIndex.textContent = index + 1;
  el.reviewTotal.textContent = queue.length;
  el.reviewScore.textContent = score;
  // build options
  const opts = buildOptions(current);
  el.optionsWrap.innerHTML = '';
  opts.forEach((opt, i)=>{
    const btn = document.createElement('button');
    btn.className = 'option';
    btn.textContent = opt;
    btn.onclick = ()=> handlePick(i, opt);
    el.optionsWrap.appendChild(btn);
  });
}

/* Handle pick */
let answered = false;
function handlePick(i, picked){
  if(answered) return;
  answered = true;
  const current = queue[index];
  const buttons = Array.from(el.optionsWrap.children);
  buttons.forEach(btn=>{
    const txt = btn.textContent;
    if(txt === current.correct) btn.classList.add('correct');
    if(txt === picked && txt !== current.correct) btn.classList.add('wrong');
    btn.disabled = true;
  });
  if(picked === current.correct){ score++; el.reviewScore.textContent = score; }
  else { wrongCards.push(current); }
  // next after delay
  setTimeout(()=>{
    answered = false;
    index++;
    if(index < queue.length) startCard();
    else show('results');
  }, 700);
}

/* Results render */
function renderResults(){
  el.finalScore.textContent = score;
  el.finalTotal.textContent = queue.length || 0;
  el.wrongList.innerHTML = '';
  if(wrongCards.length===0){
    el.wrongList.innerHTML = '<li class="small">Ø£Ø­Ø³Ù†Øª â€” Ù„Ù… ØªØ®Ø·Ø¦ Ø£ÙŠ ÙƒÙ„Ù…Ø©!</li>';
  } else {
    wrongCards.forEach(w=>{
      const li = document.createElement('li');
      li.textContent = w.word + ' â€” ' + w.correct;
      el.wrongList.appendChild(li);
    });
  }
}

/* Export / Import */
function exportJSON(){
  const data = JSON.stringify(cards, null, 2);
  const blob = new Blob([data], {type:'application/json'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'flashcards.json';
  a.click();
  URL.revokeObjectURL(a.href);
}
function importJSON(e){
  const f = e.target.files[0];
  if(!f) return;
  const r = new FileReader();
  r.onload = ()=>{
    try{
      const arr = JSON.parse(r.result);
      if(!Array.isArray(arr)) throw new Error('invalid');
      const sanitized = arr.map(it=>({
        id: it.id || uid(),
        word: it.word || '',
        correct: it.correct || it.meaning || ''
      }));
      cards = sanitized.concat(cards);
      save();
      refreshList();
      alert('ØªÙ… Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯');
    }catch(err){
      alert('Ù…Ù„Ù ØºÙŠØ± ØµØ§Ù„Ø­');
    }
  };
  r.readAsText(f);
}

/* Init */
load();
refreshList();
show('dashboard');

</script>
</body>
</html>
